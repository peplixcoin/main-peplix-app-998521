"use strict";(self.webpackChunkadmin_dashboard_template_dashwind=self.webpackChunkadmin_dashboard_template_dashwind||[]).push([[738],{2782:function(e,t,r){var a=r(3547),n=r(184);t.Z=function(e){var t=e.title,r=e.children,s=e.topMargin,i=e.TopSideButtons;return(0,n.jsxs)("div",{className:"card w-full p-6 bg-base-100 shadow-xl "+(s||"mt-6"),children:[(0,n.jsxs)(a.Z,{styleClass:i?"inline-block":"",children:[t,i&&(0,n.jsx)("div",{className:"inline-block float-right",children:i})]}),(0,n.jsx)("div",{className:"divider mt-2"}),(0,n.jsx)("div",{className:"h-full w-full pb-6 bg-base-100",children:r})]})}},3547:function(e,t,r){var a=r(184);t.Z=function(e){var t=e.styleClass,r=e.children;return(0,a.jsx)("div",{className:"text-xl font-semibold ".concat(t),children:r})}},6738:function(e,t,r){r.r(t),r.d(t,{default:function(){return v}});var a=r(2791),n=r(9434),s=r(5054),i=r(4165),c=r(1413),l=r(5861),o=r(9439),d=r(2782),u=r(1989),h=r(2426),p=r.n(h),m=r(184);var f=function(){var e=(0,a.useState)([]),t=(0,o.Z)(e,2),r=t[0],n=t[1],s=(0,a.useState)(!0),h=(0,o.Z)(s,2),f=h[0],x=h[1],b=(0,a.useState)(""),v=(0,o.Z)(b,2),g=v[0],j=v[1],k=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){var r,a,n,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},a=s.length>2&&void 0!==s[2]?s[2]:3,e.prev=2,e.next=5,u.Z.get(t,(0,c.Z)((0,c.Z)({},r),{},{timeout:5e3}));case 5:return n=e.sent,e.abrupt("return",n.data);case 9:if(e.prev=9,e.t0=e.catch(2),!(a>0)){e.next=15;break}return e.abrupt("return",k(t,r,a-1));case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){var e=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(){var t,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem("token"),e.next=4,k("".concat("https://main-peplix-app-998521.onrender.com","/api/users/withdrawals-history"),{headers:{Authorization:"Bearer ".concat(t)}});case 4:r=e.sent,n(r),j(""),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching withdrawals:",e.t0),j("Failed to load withdrawal history. Please try again.");case 13:return e.prev=13,x(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,9,13,16]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),f?(0,m.jsx)("p",{className:"text-center mt-4",children:"Loading..."}):g?(0,m.jsx)("p",{className:"text-center text-red-500",children:g}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"mt-5 grid grid-cols-1 gap-6 mb-6 animate-fadeIn",children:(0,m.jsx)(d.Z,{title:"Withdrawal History",topMargin:"mt-2",children:0===r.length?(0,m.jsx)("p",{className:"text-center",children:"No withdrawals found"}):(0,m.jsx)("div",{className:"overflow-x-auto w-full",children:(0,m.jsxs)("table",{className:"table w-full",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"Date"}),(0,m.jsx)("th",{children:"Tokens"}),(0,m.jsx)("th",{children:"Value ($)"}),(0,m.jsx)("th",{children:"Wallet Adress"}),(0,m.jsx)("th",{children:"Status"}),(0,m.jsx)("th",{children:"Transaction ID"})]})}),(0,m.jsx)("tbody",{children:r.map((function(e,t){return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"p-4",children:p()(e.requestedAt).format("DD MMM YYYY")}),(0,m.jsx)("td",{className:"p-4",children:e.noOfTokens}),(0,m.jsxs)("td",{className:"p-4",children:["$",e.value]}),(0,m.jsx)("td",{className:"p-4",children:e.upiId}),(0,m.jsx)("td",{className:"p-4",children:(r=e.status,"approved"===r?(0,m.jsx)("div",{className:"badge badge-success",children:r}):"pending"===r?(0,m.jsx)("div",{className:"badge badge-primary",children:r}):"rejected"===r?(0,m.jsx)("div",{className:"badge badge-error",children:r}):(0,m.jsx)("div",{className:"badge badge-ghost",children:r}))}),(0,m.jsx)("td",{className:"p-4",children:e.utrNo||"N/A"})]},t);var r}))})]})})})})})},x=r(7689);var b=function(){var e=(0,n.I0)(),t=(0,x.s0)(),r=(0,a.useState)(""),h=(0,o.Z)(r,2),p=h[0],b=h[1],v=(0,a.useState)(""),g=(0,o.Z)(v,2),j=g[0],k=g[1],w=(0,a.useState)(""),N=(0,o.Z)(w,2),Z=N[0],y=N[1],I=(0,a.useState)([]),S=(0,o.Z)(I,2),A=S[0],_=S[1],W=(0,a.useState)(""),C=(0,o.Z)(W,2),E=C[0],q=C[1],F=(0,a.useState)(""),D=(0,o.Z)(F,2),T=D[0],M=D[1],P=(0,a.useState)(null),R=(0,o.Z)(P,2),Y=R[0],B=R[1],z=function(){var e=(0,l.Z)((0,i.Z)().mark((function e(t){var r,a,n,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},a=s.length>2&&void 0!==s[2]?s[2]:4,e.prev=2,e.next=5,u.Z.get(t,(0,c.Z)((0,c.Z)({},r),{},{timeout:5e3}));case 5:return n=e.sent,e.abrupt("return",n.data);case 9:if(e.prev=9,e.t0=e.catch(2),!(a>0)){e.next=15;break}return e.abrupt("return",z(t,r,a-1));case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){e((0,s.hS)())}),[e]),(0,a.useEffect)((function(){var t=function(){var t=(0,l.Z)((0,i.Z)().mark((function t(){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z("".concat("https://main-peplix-app-998521.onrender.com","/api/users/transactions"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:r=t.sent,_(r),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error fetching transaction packages",t.t0),e((0,s.c0)({message:"Failed to fetch transaction packages.",status:0}));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t()}),[e]);var O=function(){var r=(0,l.Z)((0,i.Z)().mark((function r(a){var n,c,l,o,d,h;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a.preventDefault(),E){r.next=4;break}return e((0,s.c0)({message:"Please select a transaction package.",status:0})),r.abrupt("return");case 4:if(n=A.find((function(e){return e._id===E})),!(p>n.tokensAvailable)){r.next=8;break}return e((0,s.c0)({message:"Insufficient tokens in this package to withdraw.",status:0})),r.abrupt("return");case 8:if(!(n.tokensAvailable+n.tokensWithdrawn<n.min_tokens_req)){r.next=12;break}return e((0,s.c0)({message:"You need a minimum of ".concat(n.min_tokens_req," tokens to withdraw from this package."),status:0})),r.abrupt("return");case 12:if(j===Z){r.next=15;break}return e((0,s.c0)({message:"Wallet Address IDs do not match. Please re-enter.",status:0})),r.abrupt("return");case 15:return r.prev=15,r.next=18,u.Z.post("".concat("https://main-peplix-app-998521.onrender.com","/api/users/withdraw"),{noOfTokens:p,upiId:j,transactionId:E},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 18:c=r.sent,M(c.data.message),e((0,s.c0)({message:"Withdrawal Request sent successfully. Redirecting to dashboard in 5 seconds...",status:1})),b(""),k(""),y(""),q(""),B(5),l=setInterval((function(){B((function(e){return e<=1&&(clearInterval(l),t("/app/dashboard")),e-1}))}),1e3),r.next=33;break;case 29:r.prev=29,r.t0=r.catch(15),h=(null===(o=r.t0.response)||void 0===o||null===(d=o.data)||void 0===d?void 0:d.message)||"Error processing withdrawal",e((0,s.c0)({message:h,status:0}));case 33:case"end":return r.stop()}}),r,null,[[15,29]])})));return function(e){return r.apply(this,arguments)}}();return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"mt-4",children:[(0,m.jsx)("div",{className:"animate-fadeIn mx-auto shadow-lg rounded-lg",children:(0,m.jsxs)(d.Z,{title:"Withdraw Tokens",topMargin:"mt-0",children:[(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsx)("label",{htmlFor:"transactionPackage",className:"block text-lg font-semibold text-gray-600 mb-2",children:"Select Transaction Package:"}),(0,m.jsxs)("select",{id:"transactionPackage",value:E,onChange:function(e){return q(e.target.value)},className:"input input-bordered w-full p-3 border-gray-300 rounded-md",required:!0,children:[(0,m.jsx)("option",{value:"",children:"Select a package"}),A.filter((function(e){return"approved"===e.status})).map((function(e){return(0,m.jsxs)("option",{value:e._id,children:[e.packageName," - ",e.tokensAvailable.toFixed(2)," tokens available"]},e._id)}))]})]}),(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsx)("label",{htmlFor:"tokens",className:"block text-lg font-semibold text-gray-600 mb-2",children:"Enter Number of Tokens:"}),(0,m.jsx)("input",{type:"number",id:"tokens",value:p,onChange:function(e){return b(e.target.value)},className:"input input-bordered w-full p-3 border-gray-300 rounded-md",placeholder:"Enter number of tokens",required:!0})]}),(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsx)("label",{htmlFor:"upiId",className:"block text-lg font-semibold text-gray-600 mb-2",children:"Wallet Address :"}),(0,m.jsx)("input",{type:"text",id:"upiId",value:j,onChange:function(e){return k(e.target.value)},className:"input input-bordered w-full p-3 border-gray-300 rounded-md",placeholder:"Enter your Wallet Address ID",required:!0})]}),(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsx)("label",{htmlFor:"confirmUpiId",className:"block text-lg font-semibold text-gray-600 mb-2",children:"Confirm Wallet Address :"}),(0,m.jsx)("input",{type:"text",id:"confirmUpiId",value:Z,onChange:function(e){return y(e.target.value)},className:"input input-bordered w-full p-3 border-gray-300 rounded-md",placeholder:"Re-enter your Wallet Address ID",required:!0})]}),(0,m.jsx)("button",{onClick:O,className:"btn btn-primary w-full p-3 font-bold rounded-md hover:bg-blue-700 transition duration-300 mt-1",children:"Submit Withdrawal Request"}),T&&(0,m.jsx)("p",{className:"mt-4 text-center text-green-600 font-semibold",children:T}),null!==Y&&(0,m.jsxs)("p",{className:"mt-4 text-center text-gray-600 font-semibold",children:["Redirecting to dashboard in ",Y," second",1!==Y?"s":"","."]})]})}),(0,m.jsx)(f,{})]})})};var v=function(){var e=(0,n.I0)();return(0,a.useEffect)((function(){e((0,s.Iw)({title:"Withdraw"}))}),[]),(0,m.jsx)(b,{})}}}]);
//# sourceMappingURL=738.3172d4b5.chunk.js.map